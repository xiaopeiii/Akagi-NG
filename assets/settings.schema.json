{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": [
    "log_level",
    "locale",
    "game_url",
    "platform",
    "mitm",
    "server",
    "ot",
    "model_config"
  ],
  "properties": {
    "log_level": {
      "type": "string",
      "enum": ["TRACE", "DEBUG", "INFO", "WARNING", "ERROR"],
      "default": "INFO",
      "description": "Logging level."
    },
    "locale": {
      "type": "string",
      "enum": ["zh-CN", "zh-TW", "en-US", "ja-JP"],
      "default": "en-US",
      "description": "UI Language locale."
    },
    "game_url": {
      "type": "string",
      "default": "",
      "description": "Game URL for internal Electron window."
    },
    "platform": {
      "type": "string",
      "enum": ["auto", "majsoul", "tenhou", "amatsuki", "riichi_city"],
      "default": "auto",
      "description": "The target mahjong platform."
    },
    "mitm": {
      "type": "object",
      "description": "MITM proxy configuration.",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "description": "Enable MITM proxy."
        },
        "host": {
          "type": "string",
          "default": "127.0.0.1",
          "description": "MITM proxy listening host."
        },
        "port": {
          "type": "integer",
          "default": 6789,
          "description": "MITM proxy listening port."
        },
        "upstream": {
          "type": "string",
          "default": "",
          "description": "Upstream proxy URL (e.g. http://127.0.0.1:7890)."
        }
      },
      "required": ["enabled", "host", "port", "upstream"],
      "additionalProperties": false
    },
    "server": {
      "type": "object",
      "description": "Data server configuration.",
      "properties": {
        "host": {
          "type": "string",
          "default": "127.0.0.1",
          "description": "Server listening host."
        },
        "port": {
          "type": "integer",
          "default": 8765,
          "description": "Server listening port."
        }
      },
      "required": ["host", "port"],
      "additionalProperties": false
    },
    "ot": {
      "description": "Online service configuration.",
      "type": "object",
      "properties": {
        "online": {
          "type": "boolean",
          "description": "Whether to use the online service.",
          "default": false
        },
        "server": {
          "type": "string",
          "description": "The server URL for the online service.",
          "format": "uri"
        },
        "api_key": {
          "type": "string",
          "description": "The API key for the online service."
        }
      },
      "required": ["online"],
      "if": {
        "properties": {
          "online": {
            "const": true
          }
        }
      },
      "then": {
        "required": ["server", "api_key"]
      },
      "additionalProperties": false
    },
    "model_config": {
      "type": "object",
      "description": "AI model configuration.",
      "properties": {
        "model_4p": {
          "type": "string",
          "default": "mortal.pth",
          "description": "Selected model for 4-player mahjong."
        },
        "model_3p": {
          "type": "string",
          "default": "mortal3p.pth",
          "description": "Selected model for 3-player mahjong."
        },
        "temperature": {
          "type": "number",
          "default": 0.3,
          "description": "Softmax temperature for model confidence normalization."
        },
        "rule_based_agari_guard": {
          "type": "boolean",
          "default": true,
          "description": "Enable rule-based check to prevent missing wins."
        }
      },
      "required": [
        "model_4p",
        "model_3p",
        "temperature",
        "rule_based_agari_guard"
      ],
      "additionalProperties": false
    },
    "autoplay": {
      "type": "object",
      "description": "Auto-play (UI automation) configuration for Majsoul web client.",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": false,
          "description": "Enable auto-play."
        },
        "mode": {
          "type": "string",
          "enum": ["playwright", "real_mouse"],
          "default": "playwright",
          "description": "Input method: Playwright simulated mouse or real system mouse."
        },
        "auto_launch_browser": {
          "type": "boolean",
          "default": false,
          "description": "Auto launch a dedicated Chromium window using Playwright. If false, control the Electron game window (Browser Mode)."
        },
        "viewport_width": {
          "type": "integer",
          "default": 1280,
          "minimum": 800,
          "maximum": 3840,
          "description": "Browser viewport width."
        },
        "viewport_height": {
          "type": "integer",
          "default": 720,
          "minimum": 450,
          "maximum": 2160,
          "description": "Browser viewport height."
        },
        "think_delay_ms": {
          "type": "integer",
          "default": 150,
          "minimum": 0,
          "maximum": 5000,
          "description": "Delay before acting (milliseconds)."
        },
        "real_mouse_speed_pps": {
          "type": "number",
          "default": 2200.0,
          "minimum": 300.0,
          "maximum": 20000.0,
          "description": "Real mouse speed (pixels per second)."
        },
        "real_mouse_jitter_px": {
          "type": "number",
          "default": 2.0,
          "minimum": 0.0,
          "maximum": 20.0,
          "description": "Real mouse movement jitter (pixels)."
        }
      },
      "required": ["enabled", "mode", "auto_launch_browser", "viewport_width", "viewport_height"],
      "additionalProperties": false
    }
  },
  "description": "Settings for the application.",
  "additionalProperties": false
}
